---
title: "Lab 05 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Tsion"
date: "02/16/2026"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(readr) 
library(dsbox)
```

#Not sure why dsbox is not working for me, had to manually load the data files again.

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
dennys <- read_csv("data/dennys.csv")
laquinta <- read_csv("data/laquinta.csv")
```

```{r for-easier-coding}
dn <- dennys
lq <- laquinta
```

```{r check-data}
names(dn)
names(lq)
```

### Exercise 1

```{r filter-Alaska}
dn_ak <- dn %>%
  filter (state == "AK")
nrow(dn_ak)

lq_ak <- lq %>%
  filter (state == "AK")
nrow(lq_ak)
```

There are `r nrow(dn_ak)` Denny's and `r nrow(lq_ak)` La Quinta locations in the state of Alaska. 

### Exercise 2

```{r claculate-number-of-pairings}
nrow(dn_ak) * nrow(lq_ak)
```

There are `r nrow(dn_ak) * nrow(lq_ak)` pairings between all Denny's and all La Quinta locations in Alaska. 

### Exercise 3

```{r join-two-dataframes}
# we want to keep all rows and columns from both data frames. 
dn_lq_ak <- full_join(dn_ak, lq_ak,
    by = "state")
dn_lq_ak
```


### Exercise 4

```{r check-joined-dataframe}
nrow(dn_lq_ak)
names(dn_lq_ak)
```

There are `r nrow(dn_lq_ak)` observations in the joined data frame. The variables are address, city, state, zip, longitude, and latitiude for each pairing of Denny's and La Quinta labbelled as (x) and (y) for all variables (except state).

### Exercise 5

#We use the mutate function to add new variable to a data frame while keeping other viarbales constant. 

### Exercise 6

```{r load-haversine}
haversine <- function(long1, lat1, long2, lat2, round = 3) {
  # convert to radians
  long1 <- long1 * pi / 180
  lat1 <- lat1 * pi / 180
  long2 <- long2 * pi / 180
  lat2 <- lat2 * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
}
```

```{r calculate-distance-between-all-pairs}
dn_lq_ak <- dn_lq_ak %>%
  mutate (
    distance = haversine(longitude.x,latitude.x,
                         longitude.y, latitude.y)
  )
```

The following are the calculated distances between all pairs of Denny’s and La Quinta locations in Alaska: `r dn_lq_ak$distance`.

### Exercise 7

```{r calculate-minimum-distance}
#Group by Denny’s locations and calculate a new variable for min.distance. 
dn_lq_ak_minidist <- dn_lq_ak %>%
  group_by(address.x) %>%
  summarise(
    mini_dist = min(distance, na.rm = TRUE), 
    .groups = "drop"
  )

dn_lq_ak_minidist
```

### Exercise 8

```{r distribution-of-distances-of-dn-&-lq-Alaska}
#Describe distribution
summary(dn_lq_ak_minidist)

#visualization
ggplot(dn_lq_ak_minidist, aes(x = mini_dist)) + 
  geom_histogram( fill = "steelblue", color = "black") +
labs (
  title = "Distribution of Nearest La Quinta to Denny's",
  subtitle = "In Alaska",
  x = "Minimum Dsitance (km)",
  y = "Denny's Locations (count)",
) + 
  theme_bw()
```

### Exercise 9: North Carolina

```{r filter-for-NC}
dn_nc <- dn %>%
  filter(state == "NC")

lq_nc <- lq %>%
  filter(state == "NC")
```

There are `r nrow(dn_nc)` Denny's and `r nrow(lq_nc)` La Quinta locations in North Carolina. 

```{r nc-pairings}
nrow(dn_nc) * nrow(lq_nc)
```


```{r nc-join-data-frames}
dn_lq_nc <- full_join(dn_nc, lq_nc, by = "state")
```

```{r nc-add-distance-column}
dn_lq_nc <- dn_lq_nc %>%
  mutate(
    distance = haversine(longitude.x, latitude.x,
                         longitude.y, latitude.y)
  )

```

```{r nc-minimum-distance}
dn_lq_nc_minidist <- dn_lq_nc %>%
  group_by(address.x) %>%
  summarise(
    mini_dist = min(distance, na.rm = TRUE),
    .groups = "drop"
  )
dn_lq_nc_minidist
```

```{r  nc-distribution-of-distances-of-dn-&-lq}
#describe distribution 

summary(dn_lq_nc_minidist)

#visualize
ggplot(dn_lq_nc_minidist, aes(x = mini_dist)) + 
  geom_histogram( fill = "forestgreen", color = "black") +
labs (
  title = "Distribution of Nearest La Quinta to Denny's",
  subtitle = "In North Carolina",
  x = "Minimum Dsitance (km)",
  y = "Denny's Locations (count)",
) + 
  theme_bw()

```


### Exercise 10: Texas

```{r filter-for-TX}
dn_tx <- dn %>%
  filter(state == "TX")

lq_tx <- lq %>%
  filter(state == "TX")
```

There are `r nrow(dn_tx)` Denny's and `r nrow(lq_tx)` La Quinta locations in Texas. 

```{r tx-pairings}
nrow(dn_tx) * nrow(lq_tx)
```

```{r tx-join-data-frames}
dn_lq_tx <- full_join(dn_tx, lq_tx, by = "state")
```

```{r tx-add-distance-column}
dn_lq_tx <- dn_lq_tx %>%
  mutate(
    distance = haversine(longitude.x, latitude.x,
                         longitude.y, latitude.y)
  )

```

```{r tx-minimum-distance}
dn_lq_tx_minidist <- dn_lq_tx %>%
  group_by(address.x) %>%
  summarise(
    mini_dist = min(distance, na.rm = TRUE),
    .groups = "drop"
  )
dn_lq_tx_minidist
```

```{r  tx-distribution-of-distances-of-dn-&-lq}
#describe distribution 

summary(dn_lq_tx_minidist)

#visualize
ggplot(dn_lq_tx_minidist, aes(x = mini_dist)) + 
  geom_histogram( fill = "indianred", color = "black") +
labs (
  title = "Distribution of Nearest La Quinta to Denny's",
  subtitle = "In Texas",
  x = "Minimum Dsitance (km)",
  y = "Denny's Locations (count)",
) + 
  theme_bw()

```

### Exercise 11: New York 

```{r filter-for-NY}
dn_ny <- dn %>%
  filter(state == "NY")

lq_ny <- lq %>%
  filter(state == "NY")
```

There are `r nrow(dn_ny)` Denny's and `r nrow(lq_ny)` La Quinta locations in Texas. 

```{r ny-pairings}
nrow(dn_ny) * nrow(lq_ny)
```

```{r ny-join-data-frames}
dn_lq_ny <- full_join(dn_ny, lq_ny, by = "state")
```

```{r ny-add-distance-column}
dn_lq_ny <- dn_lq_ny %>%
  mutate(
    distance = haversine(longitude.x, latitude.x,
                         longitude.y, latitude.y)
  )

```

```{r ny-minimum-distance}
dn_lq_ny_minidist <- dn_lq_ny %>%
  group_by(address.x) %>%
  summarise(
    mini_dist = min(distance, na.rm = TRUE),
    .groups = "drop"
  )
dn_lq_ny_minidist
```

```{r  ny-distribution-of-distances-of-dn-&-lq}
#describe distribution 

summary(dn_lq_ny_minidist)

#visualize
ggplot(dn_lq_ny_minidist, aes(x = mini_dist)) + 
  geom_histogram( fill = "darkorange", color = "black") +
labs (
  title = "Distribution of Nearest La Quinta to Denny's",
  subtitle = "In New York",
  x = "Minimum Dsitance (km)",
  y = "Denny's Locations (count)",
) + 
  theme_bw()

```

### Exercise 12

Among all the states I have examined, Mitch Hedberg’s joke is most likely to hold true in Texas. The histogram shows a postive skew showing that for most of Denny's, there is a La Quinta nearby. 

Alaska has too few locations to make a concrete judgement. The histogram for North Carolina looks to be the most spread out, which makes it the least likely to work with the joke? Pretty much same with New York, the histograms are lot more spread out compared to Texas, but it also appears to show some skew? It's very hard to say it holds true for the joke though. 
